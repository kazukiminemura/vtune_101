# Hardware Event-based Sampling Collection
イベントベースのサンプリングの平均オーバーヘッドは、1ミリ秒のサンプリング間隔で約2％です。

## イベントリストをいくつかのイベントグループに分割
同時に収集できるハードウェアイベント（パフォーマンスモニタリングカウンタ）の数は、CPUの能力によって制限されます。通常、4つ以上のイベントを収集することはできません。この制限を克服するために  
• アプリケーションを複数回実行し、各実行時に1つのイベントグループを収集します。  
• アプリケーションを1回だけ実行し、実行中にラウンドロビン方式でイベントグループを多重化します。  
この技術は、いくつかのOS/ハードウェアの組み合わせでは機能しない場合があります。  

## VTune Profilerは以下の分析タイプでハードウェアイベントベースのサンプリングコレクターを使用
• 異常検出  
• ホットスポット（ハードウェアイベントベースのサンプリングモード  
• パフォーマンススナップショット  
• マイクロアーキテクチャ探索  
• メモリアクセス  
• GPUコンピュート/メディアホットスポット（プレビュー）  
• GPUオフロード（プレビュー）  
• システム概要  
• スレッド処理  
• HPCパフォーマンス特性評価    

## 前提条件
サンプリングドライバーをインストール(vtune101 README.mdを参照)  
システム全体およびアンコアイベントの収集を有効にするには、rootまたはsudoを使用して/proc/sys/kernel/perf_event_paranoidを0に設定します
```
echo 0 > /proc/sys/kernel/perf_event_paranoid
```
マイクロアーキテクチャ探索分析タイプでの収集を有効にするには、開かれたファイルディスクリプタのデフォルト制限を増やします。rootまたはsudoを使用して、/etc/security/limits.confのデフォルト値を100*<論理CPUコア数>に増やします。
```
<user> hard nofile <100 * 論理CPUコア数>
<user> soft nofile <100 * 論理CPUコア数>
```
